<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    
    <meta property="og:title" content="Migrating blog from Wordpress to Jekyll" />
    <meta property="og:locale" content="en" />
    <meta property="og:description" content="Living in the modern age of 0-day vulnerabilities is complicated when you have a Wordpress blog. Since I didn’t have anything fancy in there I decided to" />
    <meta property="og:url" content="https://intmaker.com/migrate-wordpress-to-jekyll/" />
    <meta property="og:site_name" content="Xpiks" />
    
    
      <link href='https://fonts.googleapis.com/css?family=Open+Sans:400|Old+Standard+TT:400' rel='stylesheet' type='text/css'>
      <link href="https://fonts.googleapis.com/css?family=Cookie&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    

    <link rel="icon" type="image/png" href="https://intmaker.com/favicon_16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="https://intmaker.com/favicon_32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://intmaker.com/favicon_128x128.png" sizes="128x128">

    <title>
      
      
         Migrating blog from Wordpress to Jekyll 
      
    </title>
    <link rel="canonical" href="https://intmaker.com/migrate-wordpress-to-jekyll/">

    <style>
  * {
    border:0;
    font:inherit;
    font-size:100%;
    vertical-align:baseline;
    margin:0;
    padding:0;
    color: black;
    text-decoration-skip: ink;
  }

  body {
    font-family:'Open Sans', 'Myriad Pro', Myriad, sans-serif;
    font-size:17px;
    line-height:160%;
    color:#1d1313;
    max-width:700px;
    margin:auto;
  }

  p {
    margin: 20px 0;
  }

  a img {
    border:none;
  }

  img {
    margin: 10px auto 10px auto;
    max-width: 100%;
    display: block;
  }

  .left-justify {
    float: left;
  }

  .right-justify {
    float:right;
  }

  pre, code {
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
    background-color: #f7f7f7;
  }

  code {
    font-size: 12px;
    padding: 4px;
  }

  pre {
    margin-top: 0;
    margin-bottom: 16px;
    word-wrap: normal;
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
  }

  pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
  }

  pre code {
    display: inline;
    max-width: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
  }

  pre code::before,
  pre code::after {
    content: normal;
  }

  em,q,em,dfn {
    font-style:italic;
  }

  .sans,html .gist .gist-file .gist-meta {
    font-family:"Open Sans","Myriad Pro",Myriad,sans-serif;
  }

  .mono,pre,code,tt,p code,li code {
    font-family:Menlo,Monaco,"Andale Mono","lucida console","Courier New",monospace;
  }

  .heading,.serif,h1,h2,h3 {
    font-family:"Old Standard TT",serif;
  }

  strong {
    font-weight:600;
  }

  q:before {
    content:"\201C";
  }

  q:after {
    content:"\201D";
  }

  del,s {
    text-decoration:line-through;
  }

  blockquote {
    font-family:"Old Standard TT",serif;
    text-align:center;
    padding:50px;
  }

  blockquote p {
    display:inline-block;
    font-style:italic;
  }

  blockquote:before,blockquote:after {
    font-family:"Old Standard TT",serif;
    content:'\201C';
    font-size:35px;
    color:#403c3b;
  }

  blockquote:after {
    content:'\201D';
  }

  hr {
    width:40%;
    height: 1px;
    background:#403c3b;
    margin: 25px auto;
  }

  h1 {
    font-size:35px;
  }

  h2 {
    font-size:28px;
  }

  h3 {
    font-size:22px;
    margin-top:18px;
  }

  h1 a,h2 a,h3 a {
    text-decoration:none;
  }

  h1,h2 {
    margin-top:28px;
  }

  #sub-header, time {
    color:#403c3b;
    font-size:13px;
  }

  #sub-header {
    margin: 0 4px;
  }

  #nav h1 a {
    font-size:35px;
    color:#1d1313;
    line-height:120%;
  }

  .posts_listing a,#nav a {
    text-decoration: none;
  }

  li {
    margin-left: 20px;
  }

  ul li {
    margin-left: 5px;
  }

  ul li {
    list-style-type: none;
  }
  ul li:before {
    content:"\00BB \0020";
  }

  #nav ul li:before, .posts_listing li:before {
    content:'';
    margin-right:0;
  }

  #content {
    text-align:left;
    width:100%;
    font-size:15px;
    padding:60px 0 80px;
  }

  #content h1,#content h2 {
    margin-bottom:5px;
  }

  #content h2 {
    font-size:25px;
  }

  #content .entry-content {
    margin-top:15px;
    margin-bottom:25px;
  }

  #content time {
    margin-left:3px;
  }

  #content h1 {
    font-size:30px;
  }

  .highlight {
    margin: 10px 0;
  }

  .posts_listing {
    margin:0 0 50px;
  }

  .posts_listing li {
    margin:0 0 25px 15px;
  }

  .posts_listing li a:hover,#nav a:hover {
    text-decoration: underline;
  }

  #nav {
    text-align:center;
    position:static;
    margin-top:60px;
  }

  #nav ul {
    display: table;
    margin: 8px auto 0 auto;
  }

  #nav li {
    list-style-type:none;
    display:table-cell;
    font-size:15px;
    padding: 0 20px;
  }

  #links {
    margin: 50px 0 0 0;
  }

  #links :nth-child(2) {
    float:right;
  }

  #not-found {
    text-align: center;
  }

  #not-found a {
    font-family:"Old Standard TT",serif;
    font-size: 200px;
    text-decoration: none;
    display: inline-block;
    padding-top: 225px;
  }

  @media (max-width: 750px) {
    body {
      padding-left:20px;
      padding-right:20px;
    }

    #nav h1 a {
      font-size:28px;
    }

    #nav li {
      font-size:13px;
      padding: 0 15px;
    }

    #content {
      margin-top:0;
      padding-top:50px;
      font-size:14px;
    }

    #content h1 {
      font-size:25px;
    }

    #content h2 {
      font-size:22px;
    }

    .posts_listing li div {
      font-size:12px;
    }
  }

  @media (max-width: 400px) {
    body {
      padding-left:20px;
      padding-right:20px;
    }

    #nav h1 a {
      font-size:22px;
    }

    #nav li {
      font-size:12px;
      padding: 0 10px;
    }

    #content {
      margin-top:0;
      padding-top:20px;
      font-size:12px;
    }

    #content h1 {
      font-size:20px;
    }

    #content h2 {
      font-size:18px;
    }

    .posts_listing li div{
      font-size:12px;
    }
  }

  @media (prefers-color-scheme: dark) {
    *, #nav h1 a {
      color: #FDFDFD;
    }

    body {
      background: #121212;
    }

    pre, code {
      background-color: #262626;
    }

    #sub-header, time {
      color: #BABABA;
    }

    hr {
      background: #EBEBEB;
    }
  }

  .decorrated .upped {
      display: none;
  }

  .decorrated:after {
    content: attr(data-n) "@" attr(data-d) "." attr(data-t); 
  }

  .sharing-icons {
      padding-left: 10px;
      margin-bottom: 20px;
  }

  section.disqus {
      margin-top: 100px;
  }

  .social-icons {
      float: right;
  }

  .social-icons a {
      font-size: 20px;
      margin-left: 10px;
  }

  @media (max-width: 30em) {
      .social-icons {
          float: left;
          padding-top: 0px;
      }
  }

  .bmc-button img {
      width: 27px !important;
      margin: 0 0 10px 0 !important;
      box-shadow: none !important;
      border: none !important;
      vertical-align: middle !important;
      display: inline !important;
  }

  .bmc-button {
      line-height: 36px !important;
      height:37px !important;
      text-decoration: none !important;
      display:inline-block !important;
      color:#000000 !important;
      background-color:#FFFFFF !important;
      border-radius: 3px !important;
      border: 1px solid transparent !important;
      padding: 1px 9px !important;
      font-size: 23px !important;
      letter-spacing: 0.6px !important;
      box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
      -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
      margin: 0 auto !important;
      font-family:'Cookie', cursive !important;
      -webkit-box-sizing: border-box !important;
      box-sizing: border-box !important;
      -o-transition: 0.3s all linear !important;
      -webkit-transition: 0.3s all linear !important;
      -moz-transition: 0.3s all linear !important;
      -ms-transition: 0.3s all linear !important;
      transition: 0.3s all linear !important;
  }

  .bmc-button:hover, .bmc-button:active, .bmc-button:focus {
      -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
      text-decoration: none !important;
      box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
      opacity: 0.85 !important;
      color:#000000 !important;
  }

  #avatar {
    background-image: url('/img/168_1.jpg');
    
     
    width: 150px;
    height: 150px;

     
    background-size: cover;

     
    background-position: top center;

     
    border-radius: 50%;

	-webkit-box-shadow: 0 0 0 5px #fff, 0 0 0 4px #999, 0 2px 5px 4px rgba(0,0,0,.1);
    -moz-box-shadow: 0 0 0 5px #fff, 0 0 0 4px #999, 0 2px 5px 4px rgba(0,0,0,.1);
    box-shadow: 0 0 0 5px #fff, 0 0 0 4px #999, 0 2px 5px 4px rgba(0,0,0,.1);

	float: left;
    margin-right: 25px;
    margin-bottom: 25px;
  }

  .related-posts {
      margin-top: 70px;
  }

  #content table {
      border-collapse: collapse;
  }

  #content table td, th {
      border: 1px solid #ddd;
      padding: 8px;
  }

  #content table tr:nth-child(even) {
      background-color: #f2f2f2;
  }

  #content table tr:hover {
      background-color: #ddd;
  }

  #content table th {
      padding-top: 12px;
      padding-bottom: 12px;
      text-align: left;
      background-color: #ccc;
      color: white;
  }

</style>


    

    <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-10412407-11', 'auto');  ga('send', 'pageview');  ga('set', 'anonymizeIp', true); </script>
  </head>

  <body>
    <section id=nav>
      <h1><a href="https://intmaker.com/">Int Maker</a></h1>
      <ul>
        
          <li><a href="https://intmaker.com/about/">About</a></li>
        
          <li><a href="https://intmaker.com/">Posts</a></li>
        
          <li><a href="https://intmaker.com/projects/">Projects</a></li>
        
      </ul>
    </section>


<section id=content>
  

  <h1> Migrating blog from Wordpress to Jekyll </h1>
  
    <div id=sub-header>
      March 2018 · 5 minute read
    </div>
  

  
  <div class="thumbnail-container">
      <a href="https://intmaker.com/migrate-wordpress-to-jekyll/">
          <img src="https://intmaker.com/img/carry.jpeg">
      </a>
  </div>
  

  <div class="entry-content">
    <p>Living in the modern age of 0-day vulnerabilities is complicated when you have a Wordpress blog. Since I didn&rsquo;t have anything fancy in there I decided to migrate it to static pages. Sounds easy? I&rsquo;m sure it does. See what it takes to migrate an average blog with images and crosslinks. I&rsquo;ve organized my process in a sort of a step by step manual.</p>
<h2 id="step-1-export-all-wordpress-data">Step 1. Export all Wordpress data</h2>
<p>Go to Wordpress admin panel, find there &ldquo;Export everything to XML&rdquo; and download it to your computer. &ldquo;Everything&rdquo; for sure should <em>not include images</em>. If you have many of them, your server will timeout especially if you bought a cheap hosting.</p>
<p>Download your media using FTP client like <a href="https://filezilla-project.org/">FileZilla</a> to a location on your computer.</p>
<h2 id="step-2-initial-import">Step 2. Initial import</h2>
<p>Jekyll provides you with rubygem which allows to do import of Wordpress website. This gem is not very nice but at least it&rsquo;s something. The problem with it that it tries literally to replicate your Wordpress website in static pages, but what we actually need is raw data (posts, pages). But we&rsquo;ll get to that as well.</p>
<p>As for now, go to <a href="http://import.jekyllrb.com/docs/wordpressdotcom/">official page of wordpress importer</a> and proceed with instructions there.</p>
<h2 id="step-3-posts-and-metadata-cleanup">Step 3. Posts and metadata cleanup</h2>
<p>All posts imported with Jekyll plugin are pretty &ldquo;dirty&rdquo;. They contain tons of useless metadata in post header which should definitely be pruned. Also many if not all links are broken along with gallery media references.</p>
<p>It will be a damn good idea to use source control and commit all the original (&ldquo;dirty&rdquo;) files in there so you will be sure you will not screw them.</p>
<p>In order to clean them up, I wrote a <a href="https://github.com/ribtoks/heap/blob/master/scripts/fix_jekyll_post.rb">simple script</a> in Ruby, but it is very specific for my needs for you to use it as is. The main idea is that I just go through each post and fix it with my script line by line:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">filepath = ARGV[0]

text = File.read(filepath)
out = File.open(filepath, <span style="font-style:italic">&#34;w&#34;</span>)

text.each_line <span style="font-weight:bold">do</span> |line|
  <span style="font-weight:bold">next</span> <span style="font-weight:bold">if</span> line =~ <span style="font-style:italic">/^type:/</span>
  <span style="font-weight:bold">next</span> <span style="font-weight:bold">if</span> line =~ <span style="font-style:italic">/^published:/</span>
  <span style="font-weight:bold">next</span> <span style="font-weight:bold">if</span> line =~ <span style="font-style:italic">/^password:/</span>
  <span style="font-weight:bold">next</span> <span style="font-weight:bold">if</span> line =~ <span style="font-style:italic">/^status:/</span>
  <span style="font-weight:bold">next</span> <span style="font-weight:bold">if</span> line =~ <span style="font-style:italic">/^parent_id:/</span>

  line.gsub!(<span style="font-style:italic">&#34;&lt;p&gt;&#34;</span>, <span style="font-style:italic">&#34;</span><span style="font-weight:bold;font-style:italic">\n</span><span style="font-style:italic">&#34;</span>)
  line.gsub!(<span style="font-style:italic">&#34;&lt;/p&gt;&#34;</span>, <span style="font-style:italic">&#34;&#34;</span>)

  line.gsub!(<span style="font-style:italic">/&lt;br[ \/]+?&gt;/</span>, <span style="font-style:italic">&#34;</span><span style="font-weight:bold;font-style:italic">\n</span><span style="font-style:italic">&#34;</span>)

  h3_match = line.match(<span style="font-style:italic">/^&lt;h3&gt;(.+)&lt;\/h3&gt;$/</span>)
  <span style="font-weight:bold">if</span> h3_match != <span style="">nil</span> <span style="font-weight:bold">then</span>
    text = h3_match.captures.first
    out.puts <span style="font-style:italic">&#34;</span><span style="font-weight:bold;font-style:italic">\n</span><span style="font-style:italic">### </span><span style="font-weight:bold;font-style:italic">#{</span>text<span style="font-weight:bold;font-style:italic">}</span><span style="font-weight:bold;font-style:italic">\n</span><span style="font-style:italic">&#34;</span>
    <span style="font-weight:bold">next</span>
  <span style="font-weight:bold">end</span>

  line = remove_gallery(line)
  line = fix_caption_images(line)
  line = fix_images(line)
  line = fix_links(line)

  out.puts line
<span style="font-weight:bold">end</span>

puts <span style="font-style:italic">&#34;Done&#34;</span>
</code></pre></div><p>As you can see I&rsquo;m just moving data from input file to output file letting all lines through some filtering and fixing.</p>
<p>For example, here&rsquo;s a code of <code>fix_caption_images()</code> routine</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">def</span> fix_caption_images(str)
  <span style="font-style:italic"># image with caption</span>
  str.gsub(<span style="font-style:italic">/\[caption.*?\]&lt;a href=\&#34;(.+?)\&#34;.*?&gt;&lt;img .*?\/&gt;&lt;\/a&gt;(.+?)\[\/caption\]/</span>) { |match|
    href, title = $1, $2
    img_path = href.sub(<span style="font-style:italic">&#34;http://url.of.my.blog.com/wp-content/uploads/&#34;</span>, <span style="font-style:italic">&#34;&#34;</span>)
    img_title = title.strip

    <span style="font-style:italic">&#34;![</span><span style="font-weight:bold;font-style:italic">#{</span>img_title<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">]({{ site.baseurl }}/assets/images/posts/</span><span style="font-weight:bold;font-style:italic">#{</span>img_path<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">)</span><span style="font-weight:bold;font-style:italic">\n</span><span style="font-style:italic">*</span><span style="font-weight:bold;font-style:italic">#{</span>img_title<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">*&#34;</span>
  }
<span style="font-weight:bold">end</span>
</code></pre></div><p>Typical Ruby/Perl regex style: you debug it, it works and you forget how it works in a month. Nevertheless, it worked flawlessly. Now all bad links, galleries and images are normalized. You just launch a script like that on every file in <code>_posts/</code> directory.</p>
<pre><code>for file in *.md ; do /path/to/your/script.rb &quot;$file&quot; ; done
</code></pre><p>Also if you have non-latin characters, Jekyll importer will make all links and filenames url-encoded. In order to fix that, just use <code>URI.decode()</code> method for links and filenames.</p>
<h2 id="step-4-images-cleanup">Step 4. Images cleanup</h2>
<p>If you will look though what you have download using FTP client, you will see tons of garbage like pregenerated all sorts of thumbnails of different sizes of your images. Of course you want to remove them:</p>
<pre><code>find -E . -type f -regex '.*-.*[0-9]+x[0-9]+\.jpg' -exec rm -rf {} \;
</code></pre><p>Also if your blog contains some worthy images, somebody can use them to sell at microstocks. You might want to use watermarks, but it&rsquo;s much easier just to scale them below 4 Megapixels so they will be useless for selling. I personally chose second option hence another <code>find</code> call:</p>
<pre><code>find . -type f \( -name '*.jpg' -o -name '*.png' -o -name '*.jpeg' \) -exec mogrify -resize 1500x1500\&gt; -quality 90 {} \;
</code></pre><p>I used <code>mogrify</code> command from <a href="https://www.imagemagick.org">ImageMagic</a> in order to scale down images and reduce their quality to 90% which is more than enough for web, but renders them useless for microstocks and saves lots of space. Also you can host images on Flickr or any other external source.</p>
<h2 id="step-5-new-blog-setup">Step 5. New blog setup</h2>
<p>Well, now you&rsquo;re kind of good to go with your own style/template. All data is properly imported and cleaned up. Just move it to your shiny template into <code>_posts</code> and <code>assets/</code> directories.</p>
<p>Edit your <code>_config.yml</code>:</p>
<ul>
<li>set production <code>url</code> of your website</li>
<li>set <code>permalink</code> style</li>
<li>set <code>gems</code> , <code>title</code> and other important properties</li>
</ul>
<h2 id="step-6-prettifying-urls">Step 6. Prettifying URLs</h2>
<p>In case you rely on url style &ldquo;<a href="http://myblog.com/mypost.html%22">http://myblog.com/mypost.html&quot;</a> and it looks a little bit ugly for you, I have good news. <em>It looks ugly for me as well</em>. I would prefer &ldquo;<a href="http://myblog.com/mypost%22">http://myblog.com/mypost&quot;</a> much more without that nasty &ldquo;.html&rdquo; in the end. And if you cannot do that in Jekyll&rsquo;s <code>_config.yml</code> for any reason, it can be easily achieved using URL Rewrite in Apache with the following rules added to your website&rsquo;s root <code>.htaccess</code> file:</p>
<pre><code>RewriteEngine On
RewriteCond %{REQUEST_URI} !^.*\.html$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^(.*)$ %{REQUEST_FILENAME}.html
</code></pre><p>Which means that if we go to url without &ldquo;.html&rdquo; and we have a file with same name and extension &ldquo;.html&rdquo; we should serve it instead of 404 page.</p>
<h2 id="enjoy-your-new-blog">Enjoy your new blog</h2>
<p>Now it&rsquo;s time to check your blog locally with <code>bundle exec jekyll serve</code> if everything works as expected. When all the minor issues are fixed would be a great time to finally publish it to GitHub Pages or just to generate static pages and upload them to your hosting (probably the same one which used to run Wordpress).</p>
  </div>

  
  <div class="sharing-icons">
    Share:&nbsp;
    <a href="https://twitter.com/intent/tweet?text=&amp;url=" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=&amp;title=" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
</div>

  <div style="margin-bottom: 20px;">
      <a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/TQOwEld1x"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span></a>

  </div>
  <div id=links>
    
      <a class="basic-alignment left" href="https://intmaker.com/fuller-stack-development/">&laquo; Fuller Stack Development</a>
    
    
      <a class="basic-alignment left" href="https://intmaker.com/deploy-to-macos/">Deploying native apps to macOS &raquo;</a>
    
  </div>

  

<div class="related-posts">
<h2>See Also</h2>
<ul>
	
	<li><a href="https://intmaker.com/autocomplete-for-english-in-c/">Implementing autocomplete for English in C&#43;&#43;</a></li>
	
	<li><a href="https://intmaker.com/generating-spiral-matrices/">Generation of spiral matrices</a></li>
	
	<li><a href="https://intmaker.com/ruby-style-loops-in-c/">Ruby style loops in C#</a></li>
	
</ul>
</div>




  
  <section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + 'codejamming' + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

  
  
</section>

  
</body>
</html>


